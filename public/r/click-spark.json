{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "click-spark",
  "type": "registry:ui",
  "dependencies": [
    "next-themes"
  ],
  "files": [
    {
      "path": "components/ui/click-spark.tsx",
      "content": "\"use client\";\r\n\r\nimport React, { useRef, useEffect, useCallback } from \"react\";\r\nimport { useTheme } from \"next-themes\";\r\n\r\ninterface Spark {\r\n  x: number;\r\n  y: number;\r\n  angle: number;\r\n  startTime: number;\r\n}\r\n\r\ninterface ClickSparkProps {\r\n  sparkColor?: string;\r\n  sparkSize?: number;\r\n  sparkRadius?: number;\r\n  sparkCount?: number;\r\n  duration?: number;\r\n  easing?: \"linear\" | \"ease-in\" | \"ease-out\" | \"ease-in-out\";\r\n  extraScale?: number;\r\n}\r\n\r\nexport const ClickSpark = ({\r\n  sparkColor,\r\n  sparkSize = 10,\r\n  sparkRadius = 15,\r\n  sparkCount = 8,\r\n  duration = 400,\r\n  easing = \"ease-out\",\r\n  extraScale = 1,\r\n}: ClickSparkProps) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const sparksRef = useRef<Spark[]>([]);\r\n  const startTimeRef = useRef<number | null>(null);\r\n  const { theme, resolvedTheme } = useTheme();\r\n\r\n  const effectiveColor = sparkColor || (resolvedTheme === \"dark\" ? \"#fff\" : \"#000\");\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    let resizeTimeout: NodeJS.Timeout;\r\n\r\n    const resizeCanvas = () => {\r\n      if (typeof window !== \"undefined\") {\r\n        const dpr = window.devicePixelRatio || 1;\r\n        canvas.width = window.innerWidth * dpr;\r\n        canvas.height = window.innerHeight * dpr;\r\n        canvas.style.width = \"100%\";\r\n        canvas.style.height = \"100%\";\r\n        \r\n        const ctx = canvas.getContext(\"2d\");\r\n        if (ctx) {\r\n          ctx.scale(dpr, dpr);\r\n        }\r\n      }\r\n    };\r\n\r\n    const handleResize = () => {\r\n      if (typeof window !== \"undefined\") {\r\n        clearTimeout(resizeTimeout);\r\n        resizeTimeout = setTimeout(resizeCanvas, 100);\r\n      }\r\n    };\r\n\r\n    if (typeof window !== \"undefined\") {\r\n      resizeCanvas();\r\n      window.addEventListener(\"resize\", handleResize);\r\n\r\n      return () => {\r\n        window.removeEventListener(\"resize\", handleResize);\r\n        clearTimeout(resizeTimeout);\r\n      };\r\n    }\r\n  }, []);\r\n\r\n  const easeFunc = useCallback(\r\n    (t: number) => {\r\n      switch (easing) {\r\n        case \"linear\":\r\n          return t;\r\n        case \"ease-in\":\r\n          return t * t;\r\n        case \"ease-in-out\":\r\n          return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n        case \"ease-out\":\r\n        default:\r\n          return t * (2 - t);\r\n      }\r\n    },\r\n    [easing]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (!ctx) return;\r\n\r\n    let animationId: number;\r\n\r\n    const draw = (timestamp: number) => {\r\n      if (!startTimeRef.current) {\r\n        startTimeRef.current = timestamp;\r\n      }\r\n\r\n      const dpr = window.devicePixelRatio || 1;\r\n      ctx.clearRect(0, 0, canvas.width / dpr, canvas.height / dpr);\r\n\r\n      sparksRef.current = sparksRef.current.filter((spark) => {\r\n        const elapsed = timestamp - spark.startTime;\r\n        if (elapsed >= duration) {\r\n          return false;\r\n        }\r\n\r\n        const progress = elapsed / duration;\r\n        const eased = easeFunc(progress);\r\n\r\n        const distance = eased * sparkRadius * extraScale;\r\n        const lineLength = sparkSize * (1 - eased);\r\n\r\n        const x1 = spark.x + distance * Math.cos(spark.angle);\r\n        const y1 = spark.y + distance * Math.sin(spark.angle);\r\n        const x2 = spark.x + (distance + lineLength) * Math.cos(spark.angle);\r\n        const y2 = spark.y + (distance + lineLength) * Math.sin(spark.angle);\r\n\r\n        ctx.strokeStyle = effectiveColor;\r\n        ctx.lineWidth = 2;\r\n        ctx.beginPath();\r\n        ctx.moveTo(x1, y1);\r\n        ctx.lineTo(x2, y2);\r\n        ctx.stroke();\r\n\r\n        return true;\r\n      });\r\n\r\n      animationId = requestAnimationFrame(draw);\r\n    };\r\n\r\n    animationId = requestAnimationFrame(draw);\r\n\r\n    return () => {\r\n      cancelAnimationFrame(animationId);\r\n    };\r\n  }, [sparkColor, effectiveColor, sparkSize, sparkRadius, sparkCount, duration, easeFunc, extraScale]);\r\n\r\n  const createSparks = useCallback((x: number, y: number) => {\r\n    const now = performance.now();\r\n    const newSparks: Spark[] = Array.from({ length: sparkCount }, (_, i) => ({\r\n      x,\r\n      y,\r\n      angle: (2 * Math.PI * i) / sparkCount,\r\n      startTime: now,\r\n    }));\r\n\r\n    sparksRef.current.push(...newSparks);\r\n  }, [sparkCount]);\r\n\r\n  const handleClick = useCallback((e: MouseEvent) => {\r\n    createSparks(e.clientX, e.clientY);\r\n  }, [createSparks]);\r\n\r\n  const handleTouchStart = useCallback((e: TouchEvent) => {\r\n    // Handle all touch points for multi-touch support\r\n    Array.from(e.changedTouches).forEach((touch) => {\r\n      createSparks(touch.clientX, touch.clientY);\r\n    });\r\n  }, [createSparks]);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    \r\n    document.addEventListener(\"click\", handleClick);\r\n    document.addEventListener(\"touchstart\", handleTouchStart, { passive: true });\r\n    \r\n    return () => {\r\n      document.removeEventListener(\"click\", handleClick);\r\n      document.removeEventListener(\"touchstart\", handleTouchStart);\r\n    };\r\n  }, [handleClick, handleTouchStart]);\r\n\r\n  return (\r\n    <canvas\r\n      ref={canvasRef}\r\n      style={{\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        position: \"fixed\",\r\n        top: 0,\r\n        left: 0,\r\n        pointerEvents: \"none\",\r\n        zIndex: 9999,\r\n      }}\r\n    />\r\n  );\r\n};\r\n",
      "type": "registry:ui",
      "target": "components/ui/click-spark.tsx"
    }
  ]
}